# RouteMarker 利用者の手引
**Version 2025年8月版**

## はじめに
RouteMarkerは、ハイキングマップの画像からポイントやルートをマーキングし、座標データを管理するツールです。登山計画の作成や、実際に歩いたルートの記録に活用できます。

## 基本的な使い方

### 1. アプリケーションの起動
1. `index.html`ファイルをWebブラウザで開きます
2. ブラウザは Chrome、Firefox、Safari、Edge の最新版を推奨します

### 2. 地図画像の読み込み
1. **「PNG画像を選択」**ボタンをクリック
2. ハイキングマップのPNG画像ファイルを選択
3. 画像が画面に表示されることを確認

**注意事項：**
- PNG形式の画像のみ対応しています
- 画像は適切なサイズに自動調整されます

### 3. レイアウトの選択
画面上部で2つのレイアウトから選択できます：
- **サイドバー**（推奨）：地図とコントロールパネルが横並び
- **オーバーレイ**：コントロールパネルが地図上に重なって表示

## ポイント編集機能

### ポイントの配置
1. **「ポイント編集」**モードを選択（デフォルト）
2. 地図上の任意の場所をクリック
3. 赤い円マーカーとID（A-01、A-02...）が表示されます

### ポイントの削除
- 既存のポイント（赤い円）をクリックすると削除されます

### ポイントのID体系
- 自動生成：A-01, A-02, ..., A-99, B-01, B-02, ..., Z-99
- 最大2,574個のポイントまで配置可能

### ポイントデータの操作
- **「ポイントをクリア」**：すべてのポイントを削除
- **「ポイントをJSON出力」**：ポイントデータをファイルに保存
- **「ポイントのJSON読込」**：以前保存したポイントデータを復元

## ルート編集機能

### ルート編集の準備
1. 先にポイント編集でルートの出発点と到着点を配置
2. **「ルート編集」**モードに切り替え

### ルートの作成手順
1. **開始ポイント**欄に出発点のID（例：A-01）を入力
2. **終了ポイント**欄に到着点のID（例：B-05）を入力
3. 地図上でルートの中間点をクリックして配置
4. 青い小さな円で中間点が表示されます

### 中間点の削除
- 既存の中間点（青い小さな円）をクリックすると削除されます

### ルートデータの操作
- **「ルートをクリア」**：中間点と開始・終了ポイント設定を削除
- **「ルートをJSON出力」**：ルートデータをファイルに保存
- **「ルートのJSON読込」**：以前保存したルートデータを復元

## ファイルの保存と読み込み

### 保存機能
データの保存時、2つの方式から選択できます：

#### 1. 自動ファイル名（推奨）
- ファイル名が自動生成されます
- 形式：`画像名_points_日付_時刻.json` または `画像名_route_日付_時刻.json`
- 例：`hakusan_points_20250819_143022.json`

#### 2. カスタムファイル名
- お好みのファイル名を指定できます
- 拡張子（.json）は自動で追加されます

### 読み込み機能
1. 各「JSON読込」ボタンをクリック
2. 以前保存したJSONファイルを選択
3. データが自動的に復元されます

**注意事項：**
- 読み込み前に同じ地図画像を読み込んでおく必要があります
- 不正なJSONファイルの場合、エラーメッセージが表示されます

## 画面の見方

### メイン画面の構成
- **地図表示エリア**：読み込んだ画像とマーカーが表示
- **コントロールパネル**：各種操作ボタンとモード切り替え
- **カウンター表示**：配置したポイント数や中間点数

### マーカーの色分け
- **赤い円**：配置したポイント（A-01, B-02等のID付き）
- **青い小円**：ルートの中間点
- **緑のハイライト**：ルート編集時の開始・終了ポイント
- **線**：開始点→中間点→終了点を結ぶルートライン

## よくある質問

### Q: 画像が表示されません
A: PNG形式の画像ファイルであることを確認してください。JPEG、GIF等は対応していません。

### Q: ポイントを間違って配置しました
A: 同じポイントをもう一度クリックすると削除されます。

### Q: ルートの開始・終了ポイントを設定できません
A: 開始・終了ポイントは、先にポイント編集で配置したポイントのIDを入力する必要があります。

### Q: JSONファイルが読み込めません
A: 以下を確認してください：
- RouteMarkerで出力したJSONファイルであること
- ファイルが破損していないこと
- 読み込み前に対応する地図画像を読み込んでいること

### Q: データが消えてしまいました
A: RouteMarkerはブラウザ内でのみ動作します。定期的にJSONファイルとして保存することをお勧めします。

## 活用例

### 登山計画の作成
1. 登山ルートマップのPNG画像を読み込み
2. 主要なポイント（山頂、山小屋、分岐点等）を配置
3. 計画ルートを中間点で詳細に設定
4. データを保存して登山当日に参照

### 実歩行記録の作成
1. 実際に歩いたルートの地図を読み込み
2. 立ち寄ったポイントや印象的な場所を記録
3. 実際の歩行ルートを中間点で再現
4. 記録として保存し、後日振り返りに活用

### 複数ルートの比較検討
1. 同じ地図で複数のルートパターンを検討
2. それぞれ別のJSONファイルとして保存
3. 必要に応じて読み込み直して比較

## 技術情報

### 対応ブラウザ
- **推奨**：Chrome 86以降、Firefox 最新版、Safari 最新版、Edge 最新版
- **必要な機能**：HTML5 Canvas、FileReader API対応

### データ形式
- **入力**：PNG画像
- **出力・保存**：JSON形式（座標データとメタデータ）

### プライバシー
- すべての処理はブラウザ内で完結
- インターネット接続や外部サーバーへのデータ送信は不要
- データはローカルファイルのみに保存

---

**困ったときは**  
操作方法がわからない場合は、この手引を再度ご確認ください。それでも解決しない場合は、ブラウザを更新してやり直してみてください。

**最終更新**: 2025年8月19日